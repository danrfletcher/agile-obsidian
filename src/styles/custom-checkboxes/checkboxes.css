/* Task icon styling â€“ clean-room implementation (no external fonts).
   All rules are scoped behind body[data-agile-checkbox-styles] so we can
   enable/disable them at runtime from the plugin. */
body[data-agile-checkbox-styles] {
	--task-icon: "";
	--task-fg: currentColor;
	--task-size: 1em; /* tweak icon size */
	--task-offset-y: 0.1em; /* vertical nudging */
}

/* Make rendered checkboxes visible regardless of container/theme */
body[data-agile-checkbox-styles]
	li
	> input[type="checkbox"],
body[data-agile-checkbox-styles]
	li
	> p
	> input[type="checkbox"] {
	opacity: 1 !important;
	visibility: visible !important;
	display: inline-block !important;
}

/* Base hook for editor tokens and rendered checkboxes
   Apply ONLY to custom tokens (not [ ], [x], [X], [""]) */
body[data-agile-checkbox-styles]
	.markdown-source-view.mod-cm6
	.task-list-item-checkbox[data-task]:not([data-task=" "]):not(
		[data-task="x"]
	):not([data-task="X"]):not([data-task=""])::before,
body[data-agile-checkbox-styles]
	.cm-s-obsidian
	span.hmd-hidden-token.cm-formatting-task[data-task]:not(
		[data-task=" "]
	):not([data-task="x"]):not([data-task="X"]):not([data-task=""])::before,
/* Rendered/reading/preview/custom views â€“ support both li > input and li > p > input */
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> input[type="checkbox"]::before,
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> p
	> input[type="checkbox"]::before {
	content: var(--task-icon);
	display: inline-block;
	color: var(--task-fg);
	font-size: var(--task-size);
	line-height: 1;
	transform: translateY(var(--task-offset-y));
	margin-right: 0.15em;
}

/* Ensure default checkbox visuals donâ€™t fight ours
   Apply ONLY to custom tokens */
body[data-agile-checkbox-styles]
	.markdown-source-view.mod-cm6
	.task-list-item-checkbox[data-task]:not([data-task=" "]):not(
		[data-task="x"]
	):not([data-task="X"]):not([data-task=""]),
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> input[type="checkbox"],
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> p
	> input[type="checkbox"] {
	background: transparent !important;
	box-shadow: none !important;
}

/* Optional: normalize strike behavior
   Keep strike for [x] and [-]; remove it for other custom tokens when .chkbx-strike is not set */
body[data-agile-checkbox-styles]:not(.chkbx-strike)
	.markdown-source-view.mod-cm6
	.HyperMD-task-line[data-task]:not([data-task=" "]):not(
		[data-task="x"]
	):not([data-task="-"]),
body[data-agile-checkbox-styles]:not(.chkbx-strike)
	.task-list-item.is-checked:not([data-task="x"]):not([data-task="-"]) {
	text-decoration: none !important;
}

/* Checked text variants (edit as you prefer) */
body[data-agile-checkbox-styles]
	.HyperMD-task-line[data-task="x"],
body[data-agile-checkbox-styles]
	.task-list-item.is-checked[data-task="x"] {
	font-weight: 600;
}

/* Ensure cancelled [-] is struck through and greyed out like [x] */
body[data-agile-checkbox-styles]
	.HyperMD-task-line[data-task="-"],
body[data-agile-checkbox-styles]
	.task-list-item.is-checked[data-task="-"] {
	color: var(--lines, var(--text-faint));
	text-decoration: line-through !important;
	text-decoration-thickness: inherit;
	text-decoration-color: currentColor;
	opacity: 0.8; /* subtle dim effect */
	font-weight: inherit; /* keep same weight as other tasks */
}

/* Token â†’ icon + color mapping */
body.theme-dark[data-agile-checkbox-styles] {
	--col-q: #fdaf00;
	--col-h: #5c7699;
	--col-d: #3e4552;
	--col-i: #c22a2a;
	--col-a: #f872b5;
	--col-R: #aab3ca;
	--col-id: #e7e7ab;
	--col-B: #885ee9;
	--col-P: #4fa54f;
	--col-C: #cf4343;
	--col-N: #855b41;
	--col-b: #e6813f;
	--col-I: #528bd4;
	--col-c: #95e9ee;
	--col-r: #f9be7b;
}

body.theme-light[data-agile-checkbox-styles] {
	--col-q: #fdaf00;
	--col-h: #a8b1bd;
	--col-d: #cad3eb;
	--col-i: #db0101;
	--col-a: #f872b5;
	--col-R: #9fbadf;
	--col-id: #cac700;
	--col-B: #b676ff;
	--col-P: #4fa54f;
	--col-C: #d66c6c;
	--col-N: #a16a49;
	--col-b: #fb924c;
	--col-I: #528bd4;
	--col-c: #95d9ee;
	--col-r: #f9be7b;
}

/* Helper to assign icon/color per token */
body[data-agile-checkbox-styles] [data-task] {
	--task-icon: "";
	--task-fg: var(--text-normal);
}

/* [X] Checked */
body[data-agile-checkbox-styles] [data-task="X"] {
	--task-icon: "âœ”ï¸";
	--task-fg: var(--text-accent, var(--accent));
}

/* [>] Forward */
body[data-agile-checkbox-styles] [data-task=">"] {
	--task-icon: "âž¤";
}

/* [D] Deferred / Calendar */
body[data-agile-checkbox-styles] [data-task="D"] {
	--task-icon: "ðŸ“…";
	--task-fg: var(--col-h);
}

/* [-] Cancelled / line */
body[data-agile-checkbox-styles] [data-task="-"] {
	--task-icon: "âŒ";
	--task-fg: var(--col-d);
}

/* [?] Question */
body[data-agile-checkbox-styles] [data-task="?"] {
	--task-icon: "â“";
	--task-fg: var(--col-q);
}

/* [!] Important */
body[data-agile-checkbox-styles] [data-task="!"] {
	--task-icon: "â—";
	--task-fg: var(--col-i);
}

/* [+] Add */
body[data-agile-checkbox-styles] [data-task="+"] {
	--task-icon: "âž•";
	--task-fg: var(--col-a);
}

/* [/] Half done */
body[data-agile-checkbox-styles] [data-task="/"] {
	--task-icon: "â››";
	--task-fg: var(--text-accent, var(--accent));
}

/* [R] Review */
body[data-agile-checkbox-styles] [data-task="R"] {
	--task-icon: "ðŸ”Ž";
	--task-fg: var(--col-R);
}

/* [i] Idea */
body[data-agile-checkbox-styles] [data-task="i"] {
	--task-icon: "ðŸ’¡";
	--task-fg: var(--col-id);
}

/* [B] Brainstorm */
body[data-agile-checkbox-styles] [data-task="B"] {
	--task-icon: "ðŸ’­";
	--task-fg: var(--col-B);
}

/* [P] Pro */
body[data-agile-checkbox-styles] [data-task="P"] {
	--task-icon: "ðŸ‘";
	--task-fg: var(--col-P);
}

/* [C] Con */
body[data-agile-checkbox-styles] [data-task="C"] {
	--task-icon: "ðŸ‘Ž";
	--task-fg: var(--col-C);
}

/* [I] Info */
body[data-agile-checkbox-styles] [data-task="I"] {
	--task-icon: "â„¹ï¸";
	--task-fg: var(--col-I);
}

/* [Q] Quote (closing) */
body[data-agile-checkbox-styles] [data-task="Q"] {
	--task-icon: "ðŸ”Š";
	--task-fg: var(--col-R);
}

/* [N] Note */
body[data-agile-checkbox-styles] [data-task="N"] {
	--task-icon: "ðŸ“";
	--task-fg: var(--col-N);
}

/* [b] Bookmark */
body[data-agile-checkbox-styles] [data-task="b"] {
	--task-icon: "â›”";
	--task-fg: var(--col-b);
}

/* [p] Prioritize */
body[data-agile-checkbox-styles] [data-task="p"] {
	--task-icon: "â†’";
	--task-fg: var(--col-R);
}

/* [E] Example */
body[data-agile-checkbox-styles] [data-task="E"] {
	--task-icon: "âœŽ";
	--task-fg: var(--col-I);
}

/* [L] Location */
body[data-agile-checkbox-styles] [data-task="L"] {
	--task-icon: "ðŸ“";
	--task-fg: var(--col-N);
}

/* [A] Answer */
body[data-agile-checkbox-styles] [data-task="A"] {
	--task-icon: "ðŸ…°ï¸";
	--task-fg: var(--col-P);
}

/* [r] Recurring */
body[data-agile-checkbox-styles] [data-task="r"] {
	--task-icon: "ðŸ”";
	--task-fg: var(--col-r);
}

/* [c] Choice */
body[data-agile-checkbox-styles] [data-task="c"] {
	--task-icon: "ðŸ”˜";
	--task-fg: var(--col-c);
}

/* [o] Option */
body[data-agile-checkbox-styles] [data-task="o"] {
	--task-icon: "âš™ï¸";
	--task-fg: var(--col-b);
}

/* [d] Doing */
body[data-agile-checkbox-styles] [data-task="d"] {
	--task-icon: "âš¬";
	--task-fg: var(--col-I);
}

/* [T] Time */
body[data-agile-checkbox-styles] [data-task="T"] {
	--task-icon: "â°";
	--task-fg: var(--col-R);
}

/* [@] Person / Character */
body[data-agile-checkbox-styles] [data-task="@"] {
	--task-icon: "ðŸ‘¤";
	--task-fg: var(--col-b);
}

/* [t] Talk */
body[data-agile-checkbox-styles] [data-task="t"] {
	--task-icon: "ðŸ’¬";
	--task-fg: var(--col-R);
}

/* [O] Outline */
body[data-agile-checkbox-styles] [data-task="O"] {
	--task-icon: "ðŸ—‚ï¸";
}

/* [W] World */
body[data-agile-checkbox-styles] [data-task="W"] {
	--task-icon: "ðŸŒ";
	--task-fg: var(--col-P);
}

/* [F] Foreshadow */
body[data-agile-checkbox-styles] [data-task="F"] {
	--task-icon: "ðŸŒ˜";
	--task-fg: var(--col-h);
}

/* [f] Clue / Find */
body[data-agile-checkbox-styles] [data-task="f"] {
	--task-icon: "ðŸ§­";
	--task-fg: var(--col-N);
}

/* [~] Conflict */
body[data-agile-checkbox-styles] [data-task="~"] {
	--task-icon: "âš”ï¸";
	--task-fg: var(--col-C);
}

/* [H] Health */
body[data-agile-checkbox-styles] [data-task="H"] {
	--task-icon: "â¤ï¸";
	--task-fg: var(--col-a);
}

/* [&] Symbolism */
body[data-agile-checkbox-styles] [data-task="&"] {
	--task-icon: "â™¾ï¸";
	--task-fg: var(--col-B);
}

/* [s] Secret */
body[data-agile-checkbox-styles] [data-task="s"] {
	--task-icon: "ðŸ”’";
	--task-fg: var(--col-d);
}

body[data-agile-checkbox-styles] [data-task="w"] {
	--task-icon: "â³";
	--task-fg: var(--col-d);
}

/* Make sure the native checkbox mark doesn't overlay our icon
   Apply ONLY to custom tokens (not [ ], [x], [X], [""]) */

/* Rendered/reading/preview/custom views â€“ remove the native box so only the emoji shows */
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> input[type="checkbox"],
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> p
	> input[type="checkbox"],
/* Editor â€“ same for the source checkbox */
body[data-agile-checkbox-styles]
	.markdown-source-view.mod-cm6
	.task-list-item-checkbox[data-task]:not([data-task=" "]):not(
		[data-task="x"]
	):not([data-task="X"]):not([data-task=""]) {
	appearance: none;
	-webkit-appearance: none;
	width: 1em;
	height: 1em;
	margin-right: 0.25em;
	position: relative;

	/* Hide the visible box entirely */
	border: none !important;
	background: transparent !important;
	box-shadow: none !important;
	outline: none !important;
}

/* Ensure no box reappears on interactive states */
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> input[type="checkbox"]:is(:hover, :focus, :active, :checked),
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> p
	> input[type="checkbox"]:is(:hover, :focus, :active, :checked),
body[data-agile-checkbox-styles]
	.markdown-source-view.mod-cm6
	.task-list-item-checkbox[data-task]:not([data-task=" "]):not(
		[data-task="x"]
	):not([data-task="X"]):not([data-task=""]):is(
			:hover,
			:focus,
			:active,
			:checked
		) {
	border: none !important;
	background: transparent !important;
	box-shadow: none !important;
	outline: none !important;
}

/* Center the emoji for custom tokens (rendered + editor) */
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> input[type="checkbox"]::before,
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> p
	> input[type="checkbox"]::before,
body[data-agile-checkbox-styles]
	.markdown-source-view.mod-cm6
	.task-list-item-checkbox[data-task]:not([data-task=" "]):not(
		[data-task="x"]
	):not([data-task="X"]):not([data-task=""])::before {
	position: absolute;
	left: 50%;
	top: 50%;
	transform: translate(-50%, -50%);
	margin: 0;
}

/* Hide the themeâ€™s masked check layer ONLY for custom tokens */
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> input[type="checkbox"]:checked::after,
body[data-agile-checkbox-styles]
	li[data-task]:not([data-task=" "]):not([data-task="x"]):not(
		[data-task="X"]
	):not([data-task=""])
	> p
	> input[type="checkbox"]:checked::after,
body[data-agile-checkbox-styles]
	.markdown-source-view.mod-cm6
	.task-list-item-checkbox[data-task]:not([data-task=" "]):not(
		[data-task="x"]
	):not([data-task="X"]):not([data-task=""]):checked::after {
	content: none !important;
	-webkit-mask-image: none !important;
	background: none !important;
}

/* Strict isolation mode: NEVER alter defaults [ ], [x], [X] (including data-task="")
   Remove any baseline or safety reset rules for defaults to let Obsidian/theme handle them */